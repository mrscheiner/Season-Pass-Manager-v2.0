Triaged on 2026-01-22

Summary
- Ran repository searches for seat/pair/ticket related code.
- Key files identified: `providers/SeasonPassProvider.tsx`, `app/(tabs)/schedule.tsx`, `app/setup.tsx`, `app/(tabs)/index.tsx` (dashboard), several scripts under `scripts/` and `constants/`.

High-level findings
1) Ticket counting logic is spread across multiple places and may be inconsistent:
   - `providers/SeasonPassProvider.tsx` contains sales data, transforms, and several stats calculations; comments indicate "Treat each sale record as a single ticket (1 seat) for simplicity." (around lines ~1956).
   - `app/(tabs)/schedule.tsx` computes ticketsPerGame = activeSeasonPass.seatPairs.length * 2 and ticketsSold = soldPairsCount * 2 (i.e. assumes each pair = 2 seats), then derives ticketsAvailable.
   - `app/(tabs)/index.tsx` and `analytics.tsx` read calculateStats.* which come from the provider computed values.
   - Potential mismatch: provider comment says treat sale record as single seat while UI uses pair * 2 semantics. This can lead to wrong numbers shown in the dashboard and schedule.

2) Seat pair data and sale records
   - `providers/SeasonPassProvider.tsx` holds a large `salesData` sample and code which converts pair records into a transformed shape. The sales data stores `seats: "1-2"` etc. Some sales have `price: 0` or `pending` statuses — edge-cases to account for.
   - `app/setup.tsx` manages user entry of seat pairs; validation exists for presence of section/row/seats but may not validate seat formatting (e.g., `1-2` expected)

3) Removal and persistence
   - `removeSeatPair` handler exists in provider around line ~862. Need to verify it updates salesData/saved state correctly and persists to storage.

4) Scripts and data sources
   - `scripts/csv-to-recovery.js` and `scripts/*ticketmaster.js` show mapping logic and methods used to create recovery/sample data — helpful for test fixtures.

Immediate recommended priorities (short list)
1) Fix/verify ticket-count correctness (HIGH)
   - Goal: ensure dashboard and schedule show consistent ticketsSold/ticketsTotal/ticketsAvailable numbers.
   - Action: reconcile semantics across provider and UI (either treat sale records as seats or pairs consistently). Add unit tests or small runtime assertions.
   - Files: `providers/SeasonPassProvider.tsx`, `app/(tabs)/schedule.tsx`, `app/(tabs)/index.tsx`, `app/(tabs)/analytics.tsx`.
   - Estimated time: 1–3 hours.

2) Seat entry validation + UX (MED)
   - Add stronger validation in `app/setup.tsx` for `seats` format and prevent adding duplicates.
   - Files: `app/setup.tsx`, `providers/SeasonPassProvider.tsx`.
   - Estimated time: 1–2 hours.

3) Remove seat-pair bug investigation (MED)
   - Confirm `removeSeatPair` correctly updates both seatPairs and salesData and persists. Add a unit/integration test or run app flow.
   - Files: `providers/SeasonPassProvider.tsx`.
   - Estimated time: 1–2 hours.

4) Data imports & scripts (LOW -> MED)
   - Review scripts that pre-generate recovery/schedule JSONs for edge-cases like missing `ticketStatus` or price=0.
   - Files: `scripts/*`, `constants/*`.
   - Estimated time: 1–2 hours.

Edge cases to test
- Pair has `paymentStatus` pending vs paid.
- Pair with price 0 (seen in sample data) — should it count as sold? (UX decision)
- Seats string malformed (e.g., "24 - 25", "24,25", single seat "24")
- Duplicate seat pairs added by user
- Removing a seat pair that has sales — does it also remove historical sales entries?

Next immediate steps I can take now (pick one):
A) Create the triage note (done).
B) Reconcile ticket counting and implement a small fix + tests (I can implement and run quick build/tests).
C) Add seat format validation in setup flow.
D) Investigate removeSeatPair and add unit tests / console checks.

What I did now
- Searched for relevant tokens and located the primary code regions.
- Created this triage file: `triage/2026-01-22-triage.md` in the repo.

What I suggest next
- Confirm you want me to start on (1) reconcile ticket-count logic now — I can implement the fix and add a small test or console checks and run the app build smoke-check. Or tell me which of the immediate steps B/C/D you prefer.

If you want me to start the ticket-count fix, I'll:
1) Add a small unit/test in a new file or add runtime assertions in provider to ensure consistent semantics.
2) Update UI calculations in `schedule.tsx` to use provider-sourced numbers (single source of truth).
3) Run quick build/lint (if present) and report back.

Assumptions I made
- "Ticket" semantics: most of UI expects pairs of seats -> 2 tickets per pair; provider comments indicate a simplified accounting. I recommend aligning on pair->2 seats consistently.
- No CI tests were present for this domain logic; I'll add small tests locally if you want.

Notes
- I did not change code yet. Ready to proceed once you pick the next action.

